import React, { useState, useRef } from "react";
a.href = url;
a.download = (filename || "data").replace(/\.[^.]+$/, "") + ".csv";
a.click();
URL.revokeObjectURL(url);
};


return (
<div className="max-w-4xl mx-auto p-6">
<div className="bg-white shadow-md rounded-2xl p-6">
<h1 className="text-2xl font-semibold mb-2">Excel Uploader</h1>
<p className="text-sm text-gray-500 mb-4">Excel (.xlsx / .xls / .csv) file upload karke data dekhein aur download karein.</p>


<div
className="border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:border-gray-400"
onDrop={onDrop}
onDragOver={onDragOver}
onClick={() => inputRef.current && inputRef.current.click()}
role="button"
>
<input
ref={inputRef}
type="file"
accept=".xlsx,.xls,.csv"
className="hidden"
onChange={onInputChange}
/>
<div className="flex flex-col items-center gap-2">
<svg xmlns="http://www.w3.org/2000/svg" className="h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 3v12m0 0l-4-4m4 4 4-4M21 12v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6" />
</svg>
<div className="text-sm text-gray-700">फाइल यहाँ ड्रैग करें या क्लिक करें</div>
<div className="text-xs text-gray-500">(.xlsx, .xls, .csv)</div>
</div>
</div>


{error && <div className="mt-4 text-red-600">{error}</div>}


{data && data.length > 0 && (
<div className="mt-6">
<div className="flex items-center justify-between mb-3">
<div>
<strong>{filename}</strong>
<div className="text-sm text-gray-500">Rows: {data.length} — Columns: {headers.length}</div>
</div>
<div className="flex gap-2">
<button onClick={downloadJSON} className="px-3 py-2 bg-blue-600 text-white rounded-lg shadow-sm">Download JSON</button>
<button onClick={downloadCSV} className="px-3 py-2 bg-green-600 text-white rounded-lg shadow-sm">Download CSV</button>
<button onClick={() => { setData([]); setHeaders([]); setFilename(""); }} className="px-3 py-2 bg-gray-200 rounded-lg">Clear</button>
</div>
</div>


<div className="overflow-auto border rounded-lg">
<table className="min-w-full table-auto text-sm">
<thead className="bg-gray-50 sticky top-0">
<tr>
{headers.map((h) => (
<th key={h} className="px-3 py-2 text-left border-b">{h}</th>
))}
</tr>
</thead>
<tbody>
{data.slice(0, 200).map((row, idx) => (
<tr key={idx} className={idx % 2 === 0 ? "bg-white" : "bg-gray-50"}>
{headers.map((h) => (
<td key={h} className="px-3 py-2 align-top border-b">
{String(row[h] ?? "")}
</td>
))}
</tr>
))}
</tbody>
</table>
</div>
{data.length > 200 && <div className="text-xs text-gray-500 mt-2">Preview limited to first 200 rows.</div>}
</div>
)}


{data.length === 0 && (
<div className="mt-4 text-sm text-gray-600">Abhi tak koi file upload nahi hui.</div>
)}


<div className="mt-6 text-xs text-gray-400">
Tip: GitHub Pages par host karne ke liye React app build karein aur gh-pages use karein, ya repo ko Netlify/Vercel par deploy karein.
</div>
</div>
</div>
);
}
